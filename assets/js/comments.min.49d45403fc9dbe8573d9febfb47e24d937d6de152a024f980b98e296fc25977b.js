document.addEventListener("click",function(g){const b=g.target,a=function(a){return document.getElementById(a)},f=function(a){return document.getElementsByClassName(a)[0]};if(b.matches("[data-toggle='reply-form']")){var e=a("cancel-button"),c=b.parentNode.parentNode,d=c.getAttribute("data-name");b.parentNode.appendChild(a("reply-form")),b.classList.toggle("d-none"),a("input-thread").value=c.getAttribute("data-thread"),a("input-parent").value=c.getAttribute("data-id"),a("input-parentName").value=d,a("reply-form-head").innerHTML="Ваш ответ "+d,e.classList.contains("d-none")&&e.classList.toggle("d-none")}b.matches("[data-toggle='reply-form-cancel']")&&(a("reply-form-head").innerHTML="Добавить комментарий",f("d-none").classList.toggle("d-none"),a("cancel-button").classList.toggle("d-none"),a("comment-thread").appendChild(a("reply-form")))},!1);const form=document.querySelector("#reply-form");form.addEventListener("submit",c=>{c.preventDefault();const a=document.getElementById("notice"),e=new FormData(form),b=new XMLHttpRequest,d={};e.forEach(function(a,b){d[b]=a});const f=Object.keys(d).map(a=>encodeURIComponent(a)+'='+encodeURIComponent(d[a])).join('&');c.submitter.setAttribute("disabled","disabled"),form.classList.toggle("loading"),a.innerHTML="Комментарий отправляется",a.classList.add("sending"),b.open("POST",form.action),b.onreadystatechange=function(d){if(b.readyState==4)if(b.status==200)form.classList.toggle("loading"),a.innerHTML="Комментарий отправлен успешно",a.classList.remove("error"),a.classList.remove("sending"),a.classList.add("success"),c.submitter.removeAttribute("disabled"),form.reset();else{let d=JSON.parse(b.responseText);form.classList.toggle("loading"),d&&d.errorCode==='RECAPTCHA_INVALID_INPUT_RESPONSE'?a.innerHTML="Ошибка отправки комментария (reCaptcha не пройдена)":a.innerHTML="Ошибка отправки комментария",a.classList.remove("success"),a.classList.remove("sending"),a.classList.add("error"),c.submitter.removeAttribute("disabled")}},b.setRequestHeader('Content-Type','application/x-www-form-urlencoded'),b.setRequestHeader('X-Requested-With','XMLHttpRequest'),b.send(f)})